<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEMINI èµ›åšé€šçµç³»ç»Ÿ v10.0 (æ­£å¼å•†ç”¨ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700;900&display=swap');
        :root { --gold: #d4af37; --gold-bright: #f9e29a; --royal-yellow: #E6B422; --dark-bg: #030303; }
        body { background-color: var(--dark-bg); color: var(--gold); font-family: 'Noto Serif SC', serif; background-image: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #050505 100%); min-height: 100vh; overflow-x: hidden; }
        
        /* é¡¶éƒ¨çœ‹æ¿ï¼šå‘¼å¸èŠ‚å¥ç¯ */
        .market-card-pulse { animation: rhythmic-glow 3s infinite ease-in-out; border: 1px solid rgba(212, 175, 55, 0.2); }
        @keyframes rhythmic-glow { 0%, 100% { border-color: rgba(212, 175, 55, 0.1); box-shadow: 0 0 5px rgba(212, 175, 55, 0.05); } 50% { border-color: rgba(212, 175, 55, 0.6); box-shadow: 0 0 20px rgba(212, 175, 55, 0.2); } }
        
        /* å¦çº¿ï¼šé»„é‡‘æ¯”ä¾‹ä¿®é•¿ */
        .gua-line { height: 14px; transition: all 0.5s ease; border-radius: 999px; }
        .yang-line { background: linear-gradient(90deg, var(--gold) 0%, var(--gold-bright) 50%, var(--gold) 100%); width: 100%; box-shadow: 0 4px 15px rgba(212,175,55,0.4); }
        .yin-line { display: flex; justify-content: space-between; width: 100%; }
        .yin-line::before, .yin-line::after { content: ''; height: 100%; width: 44%; background: linear-gradient(90deg, var(--gold) 0%, var(--gold-bright) 50%, var(--gold) 100%); border-radius: 999px; }
        
        .analysis-content { color: var(--royal-yellow); line-height: 2.2; font-size: 1.1rem; text-align: justify; }
        .analysis-content h1, .analysis-content h2, .analysis-content h3 { color: var(--gold-bright); font-weight: 900; margin: 1.5rem 0 1rem; border-bottom: 2px solid rgba(212, 175, 55, 0.2); padding-bottom: 0.5rem; display: block; }
        
        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); border: 1px solid rgba(212, 175, 55, 0.15); }
        .premium-btn { border: 1px solid transparent; background: linear-gradient(var(--dark-bg), var(--dark-bg)) padding-box, linear-gradient(45deg, #d4af37, #00f3ff, #ff00de) border-box; }
        .meditating { animation: deep-breath 2s infinite ease-in-out; pointer-events: none; }
        @keyframes deep-breath { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.7); } }

        /* æˆæƒçŠ¶æ€æ¡ */
        #auth-status-bar { transition: all 0.3s ease; height: 0; opacity: 0; overflow: hidden; font-weight: 900; }
        #auth-status-bar.show { height: auto; opacity: 1; margin-bottom: 1.5rem; padding: 0.75rem; }
    </style>
</head>
<body class="p-2 md:p-6">

    <div class="max-w-7xl mx-auto">
        <!-- é¡¶éƒ¨çœ‹æ¿ -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div id="hub-btc" class="market-card-pulse glass p-4 rounded-2xl flex justify-between items-center transition-all">
                <div><p class="text-[10px] text-zinc-400 font-black uppercase tracking-widest leading-none">Bitcoin Core</p><h3 class="text-xl font-black font-mono text-yellow-500 mt-1" id="hub-btc-price">...</h3></div>
                <div id="hub-btc-change" class="text-xs font-bold leading-none">--%</div>
            </div>
            <div id="hub-eth" class="market-card-pulse glass p-4 rounded-2xl flex justify-between items-center transition-all">
                <div><p class="text-[10px] text-zinc-400 font-black uppercase tracking-widest leading-none">Ethereum Core</p><h3 class="text-xl font-black font-mono text-gray-200 mt-1" id="hub-eth-price">...</h3></div>
                <div id="hub-eth-change" class="text-xs font-bold leading-none">--%</div>
            </div>
            <div class="glass p-4 rounded-2xl flex flex-col justify-center border border-yellow-600/40 bg-yellow-950/10">
                <div class="flex justify-between items-center mb-1">
                    <span class="text-[11px] font-black text-cyan-500 uppercase tracking-tighter" id="hub-ganzhi">åŒæ­¥ä¸­</span>
                    <span id="status-label" class="text-[9px] bg-yellow-900/60 px-2 py-0.5 rounded text-yellow-400 font-black uppercase tracking-widest leading-none">ç›‘æµ‹ä¸­</span>
                </div>
                <div class="flex justify-between items-end">
                    <div id="hub-time" class="text-xs text-cyan-200 italic font-mono font-bold">00:00:00</div>
                    <div id="usage-count" class="text-[11px] text-yellow-500 font-black">WAIT...</div>
                </div>
            </div>
            <div class="bg-cyan-950/20 border border-cyan-800/30 p-4 rounded-2xl flex flex-col justify-center shadow-xl">
                <p class="text-[10px] text-cyan-400 font-black uppercase mb-1 tracking-widest">æ¨æ¼”ç»“è®º (SUMMARY)</p>
                <div id="hub-timing-text" class="text-[11px] text-cyan-100 truncate italic">å¾…åŒæ­¥...</div>
            </div>
        </div>

        <!-- æ¿€æ´»å¤§æŒ‰é’®ï¼šç‰©ç†çº§æ¶ˆé™¤ç‚¹çŠ¶ç‰©ï¼Œä½¿ç”¨çº¯å‡€ SVG -->
        <div class="mb-8 px-1">
            <button onclick="App.toggleSettings()" class="w-full premium-btn py-5 rounded-2xl flex items-center justify-center gap-3 group hover:brightness-125 transition-all shadow-2xl active:scale-[0.99] border-none outline-none overflow-hidden relative">
                <svg class="w-5 h-5 text-yellow-500 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                <span class="text-sm font-black tracking-[0.5em] text-yellow-600 uppercase group-hover:text-yellow-400">ç³»ç»Ÿå†…æ ¸ç®¡ç†ä¸é’»çŸ³æƒé™æ¿€æ´»</span>
            </button>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <section class="lg:col-span-4 space-y-6 flex flex-col">
                <div class="glass p-8 rounded-[2.5rem] shadow-2xl relative border-t border-yellow-900/20 bg-black/20">
                    <div class="text-center mb-8"><h2 class="text-sm font-black tracking-[0.8em] text-yellow-700 uppercase">Divine Logic</h2></div>
                    <div class="space-y-8">
                        <!-- æ ‡çš„è¾“å…¥ä¸å®æ—¶ä»·æ ¼ï¼šç»å¯¹æ°´å¹³å¹³è¡Œ -->
                        <div class="flex items-center justify-between gap-4 bg-black/60 border border-yellow-900/20 p-5 rounded-2xl focus-within:border-yellow-600 transition-all h-16">
                            <input type="text" id="target-input" oninput="App.onInputChange()" placeholder="æ ‡çš„(ä¾‹: BTC)" class="flex-grow bg-transparent text-yellow-500 outline-none text-base font-black placeholder:text-zinc-800 uppercase tracking-widest h-full leading-none">
                            <div id="input-price-badge" class="text-yellow-500 font-black font-mono text-xl tracking-tighter leading-none h-full flex items-center mb-1"></div>
                        </div>
                        <div class="flex justify-around py-8 bg-black/40 rounded-[2rem] border border-yellow-900/10">
                            <div id="coin-1" class="coin-icon">?</div><div id="coin-2" class="coin-icon">?</div><div id="coin-3" class="coin-icon">?</div>
                        </div>
                        <button id="cast-btn" onclick="App.cast()" class="w-full py-6 bg-gradient-to-b from-yellow-600 to-yellow-700 text-black font-black rounded-3xl active:scale-[0.98] transition-all shadow-2xl hover:brightness-110 uppercase tracking-widest text-base italic shadow-yellow-900/20">Invoke Hexagram</button>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-6 flex-grow min-h-[460px] items-start pt-2">
                    <div class="glass p-8 rounded-[3rem] flex flex-col items-center border border-yellow-900/10 h-full">
                        <div id="gua-name-ben" class="mb-8 text-base font-black text-yellow-500 text-center h-20 flex flex-col justify-center items-center uppercase tracking-tighter leading-tight italic">æœ¬å¦å¾…èµ·</div>
                        <div id="gua-preview-ben" class="flex flex-col-reverse gap-8 w-full px-4 justify-center flex-grow"></div>
                        <p class="mt-auto pt-6 text-[10px] font-black text-yellow-800 uppercase tracking-widest opacity-60 italic">Original</p>
                    </div>
                    <div class="glass p-8 rounded-[3rem] flex flex-col items-center border border-cyan-900/10 h-full">
                        <div id="gua-name-bian" class="mb-8 text-base font-black text-cyan-500 text-center h-20 flex flex-col justify-center items-center uppercase tracking-tighter leading-tight italic">å˜å¦å¾…å®š</div>
                        <div id="gua-preview-bian" class="flex flex-col-reverse gap-8 w-full px-4 justify-center flex-grow"></div>
                        <p class="mt-auto pt-6 text-[10px] font-black text-cyan-800 uppercase tracking-widest opacity-60 italic">Transformed</p>
                    </div>
                </div>
            </section>

            <section class="lg:col-span-8 flex flex-col gap-6 text-justify">
                <div class="flex-grow glass rounded-[3.5rem] flex flex-col overflow-hidden shadow-2xl relative border border-yellow-900/10 min-h-[600px] bg-black/10">
                    <div class="px-10 py-6 border-b border-yellow-900/10 flex justify-between items-center bg-black/40">
                        <div class="flex items-center gap-3">
                            <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse shadow-[0_0_15px_#22c55e]"></span>
                            <span class="text-xs font-black tracking-[0.4em] text-yellow-900 uppercase font-mono tracking-widest leading-none">Digital Oracle Terminal</span>
                        </div>
                        <div class="flex gap-8">
                            <button onclick="App.copyAnalysis()" class="text-[11px] text-zinc-400 hover:text-yellow-600 font-black uppercase transition-all tracking-widest leading-none">å¤åˆ¶æŠ¥å‘Š</button>
                            <button onclick="App.reset()" class="text-[11px] text-red-900/80 hover:text-red-500 font-black uppercase transition-all tracking-widest leading-none">é‡ç½®ç³»ç»Ÿ</button>
                        </div>
                    </div>
                    <div id="output-console" class="p-12 flex-grow overflow-y-auto terminal-scroll text-justify">
                        <div class="mt-48 text-center italic opacity-10 tracking-[1.2em] text-yellow-900 font-black uppercase font-serif">--- ä¹¾å¤é‡ç½® Â· æ—¶ç©ºåŒæ­¥ ---</div>
                    </div>
                    <div id="action-footer" class="hidden p-10 border-t border-yellow-900/10 bg-black/60 shadow-2xl">
                        <button id="ai-btn" onclick="App.consultAI()" class="w-full py-7 premium-btn text-white font-black rounded-[2.5rem] hover:brightness-125 transition-all active:scale-[0.98] flex items-center justify-center gap-8 group shadow-2xl">
                            <span class="text-cyan-400 font-bold group-hover:animate-ping text-3xl leading-none">âœ§</span> 
                            <span id="ai-btn-text" class="tracking-[0.4em] text-xl uppercase italic font-black text-shadow-glow">æ‰§è¡Œ AI æ·±åº¦æ¨æ¼”åè®®</span> 
                            <span class="text-pink-500 font-bold group-hover:animate-ping text-3xl leading-none">âœ§</span>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- æ¿€æ´»å¼¹çª— -->
    <div id="settings-modal" class="fixed inset-0 hidden flex items-center justify-center z-50 p-6 bg-black/98 backdrop-blur-3xl">
        <div class="max-w-md w-full border border-yellow-900/30 bg-[#0a0a0a] p-10 rounded-[4rem] shadow-2xl text-xs overflow-y-auto max-h-[90vh]">
            <h3 class="text-3xl font-black mb-10 text-yellow-600 border-b border-yellow-900/20 pb-8 tracking-widest italic text-center uppercase">Cloud Identity</h3>
            <div class="space-y-6 text-center">
                <div class="p-10 bg-gradient-to-br from-yellow-950/40 to-cyan-950/40 rounded-[3.5rem] border border-yellow-900/20 shadow-inner">
                    <label class="text-yellow-500 uppercase mb-8 block font-black tracking-[0.5em] text-sm leading-none">é’»çŸ³ä¼šå‘˜æ¿€æ´»ç </label>
                    <input type="text" id="access-code-input" placeholder="è¾“å…¥16ä½åŠ å¯†å¡å¯†" class="w-full bg-black border border-cyan-900/30 p-5 rounded-2xl text-cyan-400 outline-none text-center text-lg font-mono mb-4 shadow-2xl tracking-widest uppercase">
                    
                    <div id="auth-status-bar" class="text-[10px] font-black uppercase tracking-widest bg-red-950/20 rounded-lg">SYSTEM READY</div>

                    <div class="mb-8">
                        <a href="https://shop.yunyfk.com/item/7xxbwn" target="_blank" class="block w-full py-5 bg-cyan-600 hover:bg-cyan-500 text-white font-black rounded-2xl transition-all shadow-xl uppercase tracking-widest text-xs italic">ğŸ›’ 24H è‡ªåŠ¨è´­ä¹°å¡å¯† (15å¤©)</a>
                    </div>
                    <div class="text-[13px] text-yellow-600 leading-relaxed font-black border-t border-yellow-900/20 pt-8">
                        <p class="mb-2 uppercase opacity-60 tracking-widest text-zinc-400 leading-none">æŠ€æœ¯æ”¯æŒ / æ‰‹åŠ¨å……å€¼</p>
                        <p class="text-yellow-500 text-lg select-all font-mono mt-1 leading-none">WeChat: timecoefficient</p>
                        <p class="text-yellow-400 font-bold text-[12px] mt-4 italic opacity-95 leading-relaxed">æ¿€æ´»ç ä¸€æ—¦å¼€å¯ï¼Œå°†ç»‘å®š<b class="underline font-black">æœ¬è®¾å¤‡</b> 15 å¤©æƒé™</p>
                    </div>
                </div>
            </div>
            <div class="flex gap-4 mt-12">
                <button onclick="App.saveActivation()" class="flex-grow py-5 bg-yellow-600 text-black font-black rounded-2xl active:scale-95 shadow-2xl hover:brightness-110 uppercase tracking-widest text-sm italic">éªŒè¯å¹¶å¼€å¯æƒé™</button>
                <button onclick="App.toggleSettings()" class="px-10 py-5 border border-yellow-900/20 rounded-2xl text-zinc-400 hover:text-white transition-all font-black uppercase tracking-widest text-[10px]">è¿”å›</button>
            </div>
        </div>
    </div>

    <script>
        const App = {
            config: {
                apiKeys: ["sk-I4HEv6a0W2Rfbxb2l5ZCyLMUFRmo1qmszFbJy89ScxFwexDA"],
                baseUrl: "https://once.novai.su/v1",
                model: "gemini-3-pro-preview-thinking",
                salt: "ORACLE_V10_PRO" // ä¿è¯ä¸»ç«™ä¸ç”Ÿæˆå™¨ç»Ÿä¸€
            },
            state: { guaData: [], isConsulting: false, isPremium: false, usageToday: 0, hubData: {} },

            init() { this.checkLocalStatus(); this.updateUI(); this.startMarketHub(); this.updateGanzhi(); },

            showStatus(msg, isError=true) {
                const el = document.getElementById('auth-status-bar');
                el.innerText = msg; el.classList.add('show'); el.style.color = isError ? '#ef4444' : '#22c55e';
            },

            // --- v10.0 ç»ˆæé‰´æƒé€»è¾‘ï¼šå¼ºåˆ¶å®Œæ•´æ ¡éªŒ ---
            saveActivation() {
                const rawCode = document.getElementById('access-code-input').value.trim().toUpperCase();
                if (!rawCode) return;
                
                try {
                    // æ ¸å¿ƒåˆ†æ®µæ ¡éªŒ
                    const parts = rawCode.split('-');
                    if (parts.length < 2) {
                        this.showStatus("é”™è¯¯ï¼šä½ æ˜¯å¦æ¼å¤åˆ¶äº†æ¨ªæ åé¢çš„ä»£ç ï¼Ÿ");
                        return;
                    }
                    
                    const body = parts[0]; // åŒ…å«æ‹¼éŸ³å’Œ9è¿›åˆ¶æ—¥æœŸçš„ä¸»ä½“
                    const signature = parts[1]; // 4ä½ç­¾å

                    // 1. éªŒè¯ç­¾åï¼ˆé˜²ä¼ªï¼‰
                    const calcSig = this.generateHash(body + this.config.salt);
                    if (signature !== calcSig) {
                        this.showStatus("æ ¡éªŒå¤±è´¥ï¼šå¡å¯†æŒ‡çº¹ä¸åŒ¹é… (è¯·å®Œæ•´å¤åˆ¶)");
                        return;
                    }

                    // 2. æå–æ—¥æœŸï¼ˆæŠ å‡ºæ‰€æœ‰æ•°å­—ï¼‰
                    const digits = body.replace(/\D/g, ''); // å¾—åˆ° 42108718
                    if (digits.length < 8) { this.showStatus("ç é¢æŸåï¼šæ— æ³•è§£ææ—¶é—´æˆ³"); return; }

                    // 3. 9è¿›åˆ¶ -> 10è¿›åˆ¶ -> æ ¡éªŒ15å¤©
                    const dateInt = parseInt(digits, 9);
                    const ds = dateInt.toString();
                    const codeDate = new Date(`${ds.slice(0,4)}-${ds.slice(4,6)}-${ds.slice(6,8)}`);
                    
                    const diffDays = Math.floor((new Date() - codeDate) / 86400000);

                    if (diffDays >= 0 && diffDays <= 15) {
                        localStorage.setItem('div_v10_exp', codeDate.getTime() + (15 * 86400000));
                        this.state.isPremium = true;
                        this.showStatus("æ¿€æ´»æˆåŠŸï¼15å¤©æƒé™å¼€å¯", false);
                        setTimeout(() => { this.updateUI(); this.toggleSettings(); }, 1500);
                    } else { this.showStatus("è¯¥å¡å¯†å·²è¿‡æœŸ (è¶…è¿‡15å¤©æœ‰æ•ˆæœŸ)"); }
                } catch(e) { this.showStatus("è§£æå¼‚å¸¸ï¼šæ¿€æ´»ç ç‰ˆæœ¬ä¸ç¬¦"); }
            },

            generateHash(str) {
                // DJB2 Hash
                let h = 5381;
                for (let i = 0; i < str.length; i++) h = ((h << 5) + h) + str.charCodeAt(i);
                return (h >>> 0).toString(16).toUpperCase().slice(-4).padStart(4, '0');
            },

            checkLocalStatus() {
                const exp = localStorage.getItem('div_v10_exp');
                if (exp && Date.now() < parseInt(exp)) this.state.isPremium = true;
            },

            updateGanzhi() {
                const d = new Date();
                document.getElementById('hub-time').innerText = d.toLocaleTimeString();
                setTimeout(() => this.updateGanzhi(), 1000);
            },

            async startMarketHub() {
                const fetchPrices = async () => {
                    try {
                        const [b, e] = await Promise.all([fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT'), fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=ETHUSDT')]);
                        this.state.hubData = { btc: await b.json(), eth: await e.json() };
                        let sym = document.getElementById('target-input').value.trim().toUpperCase();
                        const bEl = document.getElementById('input-price-badge');
                        if (sym && bEl) {
                            const res = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${sym}USDT`);
                            if (res.ok) {
                                const dj = await res.json();
                                bEl.innerText = `$${parseFloat(dj.lastPrice).toLocaleString()}`;
                            }
                        }
                        this.updateUI();
                    } catch (e) {}
                };
                fetchPrices(); setInterval(fetchPrices, 1000);
            },

            async cast() {
                if (this.state.guaData.length >= 6) return;
                const resArr = [1, 2, 3].map(() => Math.random() > 0.5 ? 3 : 2);
                const sum = resArr.reduce((a, b) => a + b, 0);
                this.state.guaData.push({ sum, type: (sum === 7 || sum === 9) ? 'yang' : 'yin', isMoving: (sum === 6 || sum === 9) });
                this.updateUI();
                [1,2,3].forEach((id, i) => document.getElementById(`coin-${id}`).innerText = resArr[i] === 3 ? "é˜³" : "é˜´");
            },

            async consultAI() {
                if (!this.state.isPremium && this.state.usageToday >= 1) return;
                this.state.isConsulting = true;
                document.getElementById('ai-btn-text').innerText = "ç¥æ€å…¥å®šï¼ŒåŒæ­¥æ˜Ÿè½¨...";
                document.getElementById('ai-btn').classList.add('meditating');
                try {
                    const res = await fetch(`${this.config.baseUrl}/chat/completions`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${this.config.apiKeys[0]}` },
                        body: JSON.stringify({ model: this.config.model, messages: [{ role: "user", content: "å…­çˆ»è§£å¦ã€‚è¦æ±‚çš‡å®¶é»„è§†è§‰ï¼Œä¸¥ç¦å‡ºç°ç¬¦å·ã€‚" }] })
                    });
                    const data = await res.json();
                    document.getElementById('output-console').innerHTML = `<div class="analysis-content">${marked.parse(data.choices[0].message.content.replace(/[#*_-]/g, ''))}</div>`;
                    if (!this.state.isPremium) { this.state.usageToday++; localStorage.setItem('u_cnt_v10', this.state.usageToday); }
                } catch (e) {} finally {
                    this.state.isConsulting = false;
                    document.getElementById('ai-btn-text').innerText = "æ‰§è¡Œ AI æ·±åº¦æ¨æ¼”åè®®";
                    document.getElementById('ai-btn').classList.remove('meditating');
                }
            },

            updateUI() {
                const sl = document.getElementById('status-label');
                if (sl) {
                    sl.innerText = this.state.isPremium ? "DIAMOND" : "FREE";
                    sl.className = `text-[9px] font-black px-2 py-0.5 rounded uppercase ${this.state.isPremium ? 'text-cyan-400 bg-cyan-950/60 shadow-lg' : 'text-yellow-500 bg-yellow-900/30'}`;
                }
                const uc = document.getElementById('usage-count');
                if(uc) uc.innerText = this.state.isPremium ? "INFINITY" : `Left: ${1 - this.state.usageToday}`;
                document.getElementById('gua-preview-ben').innerHTML = this.state.guaData.map(l => `<div class="flex items-center gap-3"><div class="gua-line ${l.type==='yang'?'yang-line':'yin-line'} flex-grow shadow-lg"></div><div class="w-6 text-[12px] font-black text-orange-600">${l.isMoving?(l.type==='yang'?'â—‹':'Ã—'):''}</div></div>`).join('');
                if (this.state.guaData.length === 6) {
                    const bianData = this.state.guaData.map(l => l.isMoving ? { type: (l.type === 'yang' ? 'yin' : 'yang') } : { type: l.type });
                    document.getElementById('gua-preview-bian').innerHTML = bianData.map(l => `<div class="flex items-center gap-3 px-2"><div class="gua-line ${l.type==='yang'?'yang-line':'yin-line'} flex-grow shadow-2xl shadow-cyan-950/20"></div><div class="w-4"></div></div>`).join('');
                }
                document.getElementById('action-footer')?.classList.toggle('hidden', this.state.guaData.length < 6);
            },
            toggleSettings() { document.getElementById('settings-modal').classList.toggle('hidden'); },
            reset() { location.reload(); },
            onInputChange() { let s = document.getElementById('target-input').value; if(!s) document.getElementById('input-price-badge').innerText = ""; },
            copyAnalysis() { const t = document.getElementById('output-console').innerText; const e = document.createElement('textarea'); e.value = t; document.body.appendChild(e); e.select(); document.execCommand('copy'); document.body.removeChild(e); }
        };
        window.onload = () => App.init();
    </script>
</body>
</html>
